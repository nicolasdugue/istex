package controller;

import java.io.FileNotFoundException;
import java.util.ArrayList;
import java.util.Iterator;

import com.google.gson.Gson;
import com.google.gson.GsonBuilder;

import model.diachronism.LabelDiachronism;
import model.diachronism.clustermatching.ClusterLabelled;
import model.diachronism.clustermatching.ClusterMatching;
import model.factory.Factory;
import model.util.PairFWeighted;

public class Controller {

	
	
	public static void main(String[] args) {
		LabelDiachronism ld;
		try {
			ld=Factory.matchingFromLabelFiles("00-0350gnge-tn-DD-ENL.fmgs", "96-99-F43gnge-tn-DD-ENL.fmgs");
			Iterator<String> itLabels;
			Iterator<Integer> itClusters;
			final GsonBuilder builder = new GsonBuilder();
		    final Gson gson = builder.create();
		    ClusterLabelled cs = new ClusterLabelled();
		    ClusterMatching cm = new ClusterMatching(cs);
		    ClusterLabelled ct ;
		    String label;
		    int target;
			for (int s =0; s < ld.getNbClusterSource(); s++) {
				cs.setName("G-"+s);
				itClusters=ld.getTargetClusterMatching(s).iterator();
				while (itClusters.hasNext()) {
					target=itClusters.next();
					ct = new ClusterLabelled();
					ct.setName("G-"+target);
					
					itLabels=ld.getLabelsClusterTarget(target).iterator();
					while (itLabels.hasNext()) {
						label=itLabels.next();
						ct.add(new PairFWeighted(label,ld.getFeatureValueTarget(label)));
					}	
				}
				itLabels=ld.getLabelsClusterSource(s).iterator();
				while (itLabels.hasNext()) {
					label=itLabels.next();
					cs.add(new PairFWeighted(label,ld.getFeatureValueTarget(label)));
				}	
			}
		} catch (FileNotFoundException e) {
			// TODO Auto-generated catch block
			e.printStackTrace();
		}

	}

}
