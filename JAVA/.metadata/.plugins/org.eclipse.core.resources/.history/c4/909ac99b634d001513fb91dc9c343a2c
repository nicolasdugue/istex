package io.reader;

import static org.junit.Assert.*;

import org.junit.Before;
import org.junit.Test;

import model.cluster.Clustering;
import model.featureselection.FeaturesSelection;
import model.matrix.CsrMatrix;
import model.matrix.CsrMatrixClustered;

public class TestFeaturesSelection {
	private FeaturesSelection fs;
	@Before
	public void setUp() throws Exception {
		MatrixReader iskoMaghreb = new MatrixReader("matrix_lamirel_iskomaghreb");
		iskoMaghreb.read();
		Clustering cim = new Clustering();
		cim.add(0);
		cim.add(0);
		cim.add(0);
		cim.add(1);
		cim.add(1);
		cim.add(1);
		CsrMatrixClustered  cm_im = new CsrMatrix(iskoMaghreb, cim);
		fs = new FeaturesSelection(cm_im);
	}

	
	@Test
	public void testCsrSumColCluster() {
		assertEquals(3, cm_im.getSumColInCluster(0, 0));
		assertEquals(0, cm_im.getSumColInCluster(0, 1));
		assertEquals(3, cm.getSumColInCluster(1, 0));
		assertEquals(0, cm.getSumColInCluster(1, 1));
		assertEquals(0, cm.getSumColInCluster(2, 0));
		assertEquals(4, cm.getSumColInCluster(2, 1));
		assertEquals(7, cm.getSumColInCluster(3, 0));
		assertEquals(8, cm.getSumColInCluster(3, 1));
	}
	
	@Test
	public void testGetFeatureFMeasure() {
		assertEquals(0.45, fs.getFeatureFMeasure(0, 0) ,0.01); // Bug papier ISKO MAGHREB
		assertEquals(0.22, fs.getFeatureFMeasure(0, 1) ,0.01);
		assertEquals(0.39, fs.getFeatureFMeasure(1, 0),0.01);
		assertEquals(0.66, fs.getFeatureFMeasure(1, 1),0.01);
		assertEquals(0.30, fs.getFeatureFMeasure(2, 0),0.01);
		assertEquals(0.24, fs.getFeatureFMeasure(2, 1),0.01);
	}
	@Test
	public void testGetFeatureFMeanFMeasure() {
		assertEquals(0.34, fs.getFeatureFMeanFMeasure(0),0.01);
		assertEquals(0.53, fs.getFeatureFMeanFMeasure(1) ,0.01);
		assertEquals(0.27, fs.getFeatureFMeanFMeasure(2) ,0.01);
	}
	
	@Test
	public void testGetGlobalMeanFMeasure() {
		assertEquals(0.38, fs.getGlobalMeanFMeasure(), 0.015);
	}

	

	

}
