package io.reader;

import static org.junit.Assert.*;

import org.junit.Before;
import org.junit.Test;

import model.PairI;
import model.cluster.Clustering;
import model.matrix.CsrMatrix;
import model.matrix.CsrMatrixClustered;

public class TestCsrMatrix {

	private CsrMatrix cm;
	private CsrMatrixClustered cm_im;
	@Before
	public void setUp() throws Exception {
		MatrixReader mr = new MatrixReader("matrix");
		mr.read();
		Clustering c = new Clustering();
		c.add(0);
		c.add(0);
		c.add(1);
		c.add(1);
		cm = new CsrMatrix(mr);
		
		MatrixReader iskoMaghreb = new MatrixReader("matrix_lamirel_iskomaghreb");
		iskoMaghreb.read();
		Clustering cim = new Clustering();
		cim.add(0);
		cim.add(0);
		cim.add(0);
		cim.add(1);
		cim.add(1);
		cim.add(1);
		cm_im = new CsrMatrixClustered(iskoMaghreb, cim);
	}

	@Test
	public void testCsrMatrixMatrixReader() {
		assertEquals(new PairI(0,2), cm.getIinRows(0));
		assertEquals(new PairI(3,7), cm.getIinRows(1));
		assertEquals(new PairI(0,1), cm.getIinRows(2));
		assertEquals(new PairI(1,3), cm.getIinRows(3));
		assertEquals(new PairI(3,8), cm.getIinRows(4));
		assertEquals(new PairI(2,4), cm.getIinRows(5));
		
		assertEquals(2, cm.getCumulativeRows(0));
		assertEquals(4, cm.getCumulativeRows(1));
		assertEquals(5, cm.getCumulativeRows(2));
		assertEquals(6, cm.getCumulativeRows(3));
		
		
		assertEquals(new PairI(0,2), cm.getIinColumns(0));
		assertEquals(new PairI(1,1), cm.getIinColumns(1));
		assertEquals(new PairI(1,3), cm.getIinColumns(2));
		assertEquals(new PairI(3,4), cm.getIinColumns(3));
		assertEquals(new PairI(0,7), cm.getIinColumns(4));
		assertEquals(new PairI(2,8), cm.getIinColumns(5));
		
		assertEquals(2, cm.getCumulativeColumns(0));
		assertEquals(3, cm.getCumulativeColumns(1));
		assertEquals(4, cm.getCumulativeColumns(2));
		assertEquals(6, cm.getCumulativeColumns(3));
		
	}
	
	@Test
	public void testCsrSumCol() {
		assertEquals(3, cm.getSumCol(0));
		assertEquals(3, cm.getSumCol(1));
		assertEquals(4, cm.getSumCol(2));
		assertEquals(15, cm.getSumCol(3));
	}
	
	
	
	@Test
	public void testCsrSumRow() {
		assertEquals(9, cm.getSumRow(0));
		assertEquals(4, cm.getSumRow(1));
		assertEquals(8, cm.getSumRow(2));
		assertEquals(4, cm.getSumRow(3));
	}
	@Test
	public void testSumCluster() {
		assertEquals(13, cm_im.getSumCluster(0));
		assertEquals(12, cm_im.getSumCluster(1));
	}
	
	
	
	@Test
	public void testCsrSumColCluster() {
		assertEquals(3, cm_im.getSumColInCluster(0, 0));
		assertEquals(0, cm_im.getSumColInCluster(0, 1));
		assertEquals(3, cm_im.getSumColInCluster(1, 0));
		assertEquals(0, cm_im.getSumColInCluster(1, 1));
		assertEquals(0, cm_im.getSumColInCluster(2, 0));
		assertEquals(4, cm_im.getSumColInCluster(2, 1));
		assertEquals(7, cm_im.getSumColInCluster(3, 0));
		assertEquals(8, cm_im.getSumColInCluster(3, 1));
	}
	
	
	
	
	

}
